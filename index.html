<html>
<head>
    <meta name="description" content="record label">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="icon" href="" sizes="any">

    <link rel="stylesheet" href="style.css" />

    <title>a million thoughts</title>

</head>
<body>





    <div class="container">

        <nav aria-labelledby='mainmenulabel' id='main-nav'>
            <ul>
                <li class="nav-item active"><a href="index.html">a million thoughts</a></li>
                <li class="nav-item" id="toggle-records">music</li>
                <li class="nav-item"><a href="info.html">info</a></li>
            </ul>
        </nav>

        <section id="records" style="max-height:0px;">
            <!-- <h1>records</h1> -->
            <div>
            <a href="tarantula--poesie-culture/">
                <img src="tarantula--poesie-culture/tarantula-poesieCulture-cover.jpg">
            <h5>Tarantula - Poesie Culture (2022)</h5>
        </a>
        </div>
        </section>

    <figure id="ideas-list">
        <img src='media/amillionthoughts-oneis.png' 
        alt="a hand written poem saying i have more than a million thoughts, one is 01101100001010101"/>

    <br/>
            <img src='media/another-is.png' 
        alt="a hand written poem saying another is"/>
    <!-- <div id="infinite-idea-top"><img src="media/binary/2.png"></div> -->
    </figure>

    <div id="infinite-idea-bottom"></div>
    
    <div class="fader">
        <div>
                <img src='media/wizard.jpg'
                     alt="jamie is standing" />
        </div>
        <div>
                <img src='media/wizard2.jpg'
                     alt="jamie has disappeared and all that is left are his shoes" />
        </div>
    </div>
    
<p>a million thoughts</p>

</div>



<div id="record-modal" style="display:none">
    <div id="close-record-modal">a million thoughts &#10006;</div>
    <div id="record-modal-inner">
        nothing to see
    </div>
</div>

<div style="display:none">
    <img src="media/binary/1.png"/>
    <img src="media/binary/2.png"/>
    <img src="media/binary/3.png"/>
    <img src="media/binary/4.png"/>
    <img src="media/binary/5.png"/>
    <img src="media/binary/6.png"/>
</div>

    <script>

        [].slice.call(document.getElementById('records').getElementsByTagName('a'))
        .forEach(x=>{
            x.onclick = (e) => {
                e.preventDefault();
                
                fetch(x.href + "?" + Math.random())
                .then((response) => response.text())
                .then((data)=>{
                    document.getElementById('record-modal-inner').innerHTML=data; 
                    document.getElementById('record-modal').style.display = 'block';
                    document.body.style.overflowY='hidden';
                    initModal();
                })
            }
        })

        document.getElementById('close-record-modal').onclick = ()=>{document.getElementById('record-modal').style.display = 'none';document.body.style.overflowY='scroll'}

        function initModal(){
        [].slice.call(document.querySelectorAll('#tracks li')).forEach((x,i,arr)=>{
            x.onclick = ()=>{
                arr.forEach((li)=>li.className='');
                x.className = 'active';
                document.getElementById('audio-player').src = x.dataset.track;
                document.getElementById('audio-player').play();
                document.getElementById('audio-player').style.opacity = 1;
                document.getElementById('audio-player').onended = ()=>{
                    if(i!=arr.length-1){
                        arr[i+1].click();
                      //  document.getElementById('audio-player').play();
                    }
                }
            }
        })
    }

const rgba2hex = (rgba) => `#${rgba.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+\.{0,1}\d*))?\)$/).slice(1).map((n, i) => (i === 3 ? Math.round(parseFloat(n) * 255) : parseFloat(n)).toString(16).padStart(2, '0').replace('NaN', '')).join('')}`
var binaryGenerateInterval = null;

function binaryGenerator(){
document.getElementById('infinite-idea-bottom').innerHTML = "<img src='media/binary/1.png'>";
binaryGenerateInterval = setInterval(function(){
    binaryGenerate()
},0.1)
}

// document.getElementById('infinite-idea-bottom').onclick = ()=>{
//     binaryGenerator();
// }

window.onload = ()=>{
    document.getElementById("ideas-list").style.filter = `drop-shadow(${Math.round(Math.random()*30)}px ${Math.round(Math.random()*10)}px ${Math.round(Math.random()*4)}px ${backgroundColor})`
    document.body.style.backgroundColor = backgroundColor;
    document.getElementById('records').style.borderColor = backgroundColor;
}

var backgroundColor =  rgba2hex(randomColour());

function binaryGenerate(){
var newImg = document.createElement('img');
newImg.style.backgroundColor = `${randomColour()}`;
newImg.src = "media/binary/" + Math.ceil(6 * Math.random()) + ".png";

var existingImgs = [].slice.call(document.getElementById('infinite-idea-bottom').getElementsByTagName('img'));
var randomImgIndex = Math.floor(existingImgs.length * Math.random());
document.getElementById('infinite-idea-bottom').insertBefore(newImg,existingImgs[randomImgIndex])

  if(Math.random()*25 > 24 && (existingImgs.length+1)%17==0){
    clearInterval(binaryGenerateInterval);
  var binaryColorsInterval = setInterval(function(){
        binaryColors();
    },0.1)

    setTimeout(function(){
        clearInterval(binaryColorsInterval);
    },10000)
}



}



function binaryColors(){

var existingImgs = [].slice.call(document.getElementById('infinite-idea-bottom').getElementsByTagName('img'));

var randomImgIndex = Math.floor(existingImgs.length * Math.random());

existingImgs[randomImgIndex].style.backgroundColor = `${randomColour()}`;

existingImgs.forEach((x,i)=>{
    if(((i+1)%17==0)){
        x.style.backgroundColor = backgroundColor;
    }
})

}

function randomColour(){
    var r = Math.round(Math.random() * 255);
    var g = Math.round(Math.random() * 255);
    var b = Math.round(Math.random() * 255);
    var rgba = "rgba(" + r + "," + g + "," + b + ",0.5)";

    return rgba;
}


binaryGenerator();


document.getElementById('toggle-records').onclick = ()=>{
    var recordsEl = document.getElementById('records');
    var toggleEl = document.getElementById('toggle-records');
    if(toggleEl.classList.contains('active')){
        toggleEl.classList.remove('active');
        recordsEl.style.maxHeight='0px';
      //  recordsEl.style.maxWidth='0px';
    }else{
        recordsEl.style.maxHeight='500px';
     //   recordsEl.style.maxWidth='1000px';
        toggleEl.classList.add('active');
    }

}

    </script>

</body>
</html>